<script>
	var $_GET = [];
	function get_userid() {

		window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(a,
				name, value) {
			$_GET[name] = value;
		});
		return $_GET['userid'];
	}

	function add_review() {
		userid = get_userid();
		company_id = $('#company_select').find(":selected").val();
		review = $('#review').val();
		rating = $('#rating').val();

		$.ajax({
			url : "addReview.php", //the page containing php script
			type : "post", //request type,
			dataType : 'json',
			data : {
				userid : userid,
				company_id : company_id,
				review : review,
				rating : rating
			},
			success : function(request, status, error) {
				window.location.href = 'review.php?userid=' + userid;

			},
			error : function(request, status, error) {
				alert(request.responseText);
				event.preventDefault();
			}
		});

	}
	function replace_option(txt) {
		var options = txt.split(',');
		var newOptions = [];
		var $el = $("#company_select");
		$el.empty(); // remove old options

		
			options.forEach(function(key, value) {
				opt = key.split('=>');
				$el.append($("<option></option>").attr("value", opt[0])
						.text(opt[1]));
			});
		

	}
	function get_all_company() {

		$.ajax({
			url : "/nxthire/html/employer/getCompany.php", //the page containing php script
			type : "get", //request type,
			dataType : 'json',
			success : function(response) {
			
			   replace_option(response["message"]);

			},
			error : function(request, status, error) {
				alert(request.responseText);
				event.preventDefault();
			}
		});

	}
</script>
<div class="container">
	<div class="row">
		<div class="col-sm-8">

			<form id="addeduform">
				<div class="form-group">
					<label for="name">Company</label> <select class="form-control"
						id="company_select" name="company_select"></select>
					<div class="valid-feedback">Valid.</div>
					<div class="invalid-feedback">Please fill out this field.</div>
				</div>
				<div class="form-group">
					<label for="rev">Review:</label> <input type="text"
						class="form-control" id="review" name="review" required>
					<div class="valid-feedback">Valid.</div>
					<div class="invalid-feedback">Please fill out this field.</div>
				</div>
				<div class="form-group">
					<label for="rate">Rating:</label> <input type="text"
						class="form-control" id="rating" name="rating" required>
					<div class="valid-feedback">Valid.</div>
					<div class="invalid-feedback">Please fill out this field.</div>
				</div>
				<button type="button" id="btnSubmit" class="btn btn-secondary"
					onclick="add_review()">Submit</button>
			</form>
		</div>
	</div>
</div>
<script>
	$(document).ready(function() {
		get_all_company();
	});
</script>
