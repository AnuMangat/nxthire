<!DOCTYPE html>
<html lang="en">
<head>

<div id="header"></div>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="/nxthire/js/login_replace.js"></script>
<script>
	hide_login_text();

	/* $(function() { //shorthand document.ready function
	    $('#login_form').on('submit', function(e) { //use on if jQuery 1.7+
	        e.preventDefault();  //prevent form from submitting
	        var data = $("#login_form :input").serializeArray();
	        console.log(data); //use the console for debugging, F12 in Chrome, not alerts
	    });
	});
	 */
	function add_user() {

		//event.preventDefault();

		name = $('#name').val();
		uname = $('#uname').val();
		company_id = $('#company_select').find(":selected").val();		

		pswd = $('#pswd').val();

		$.ajax({
			url : "add_user.php", //the page containing php script
			type : "post", //request type,
			dataType : 'json',
			data : {
				name : name,
				uname : uname,
				company_id : company_id,
				pswd : pswd
			},
			success : function(request, status, error) {

				window.location.href = 'main.php?userid=' + uname;

			},
			error : function(request, status, error) {
				alert(error);
			}
		});

	}

	function replace_option(txt) {
		var options = txt.split(',');
		var newOptions = [];
		var $el = $("#company_select");
		$el.empty(); // remove old options

		options.forEach(function(key, value) {
			opt = key.split('=>');
			$el.append($("<option></option>").attr("value", opt[0])
					.text(opt[1]));
		});

	}

	function get_all_company() {

		$.ajax({
			url : "/nxthire/html/employer/getCompany.php", //the page containing php script
			type : "get", //request type,
			dataType : 'json',
			success : function(response) {

				replace_option(response["message"]);

			},
			error : function(request, status, error) {
				alert(request.responseText);
				event.preventDefault();
			}
		});

	}
</script>
</head>
<body>



	<div class="container">
		<div class="row">
			<div class="col-sm-3">

				<form id="createuserform">
					<div class="form-group">
						<label for="name">Company</label> <select class="form-control"
							id="company_select" name="company_select"></select>
						<div class="valid-feedback">Valid.</div>
						<div class="invalid-feedback">Please fill out this field.</div>
					</div>
					<div class="form-group">
						<label for="name">Name:</label> <input type="text"
							class="form-control" id="name" placeholder="Enter Name"
							name="name" required>
						<div class="valid-feedback">Valid.</div>
						<div class="invalid-feedback">Please fill out this field.</div>
					</div>
					<div class="form-group">
						<label for="uname">Username:</label> <input type="text"
							class="form-control" id="uname" placeholder="Enter username"
							name="uname" required>
						<div class="valid-feedback">Valid.</div>
						<div class="invalid-feedback">Please fill out this field.</div>
					</div>
		
					<div class="form-group">
						<label for="pwd">Password:</label> <input type="password"
							class="form-control" id="pswd" placeholder="Enter password"
							name="pswd" required>
						<div class="valid-feedback">Valid.</div>
						<div class="invalid-feedback">Please fill out this field.</div>
					</div>
					<button type="button" id="btnSubmit" class="btn btn-secondary"
						onclick="add_user()">Submit</button>
				</form>
			</div>
		</div>
	</div>


	<div id="footer"></div>
	<script>
		$(document).ready(function() {
			get_all_company();
		});

		$("#header").load("/nxthire/html/util/header.html");
		$("#footer").load("/nxthire/html/util/footer.html");

		$(document).ready(function() {
			hide_login_text_partial();
		});
	</script>
</body>
</html>
